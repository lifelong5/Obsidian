# 热更新
玩家在首次下载过游戏之后，之后的游戏的更新不需要重新全部打包，再次下载完整的游戏，而是在原有的基础上，更新游戏的内容。
## 使用lua进行热更新
### lua编写游戏逻辑
在unity环境中内嵌一个lua的虚拟机，经常发生变动和对执行效率没有要求的逻辑用lua实现，启动游戏时加载服务器商最新的lua字节码来执行游戏。
lua代码是在运行时候才编译，不允许时候是文本文件，所以更新的时候只需要更换lua脚本即可，不需要编译之后再打包，因此lua可以实现热更新。
### C#反射技术
可以将部分逻辑提取至一个单独的代码库工程中，打包为DLL
将DLL打包为AssetBundle，Unity程序动态加载AssetBundle中的DLL文件，使用反射机制来调用代码。
用C#反射加载程序集的方式可以动态的从assetBundle资源包或其他资源包里加载脚本到工程中。
### tolua的使用
Tolua是Unity静态绑定lua的一个解决方案，它通过C#中集成lua的插件，可以自动生成用于在lua中访问Unity的绑定代码，并把C#中的常量、变量、函数、属性、类以及枚举暴露给lua。其从cstolua衍变而来。
### c#中调用Tolua的基本操作
![[Pasted image 20230411101030.png]]